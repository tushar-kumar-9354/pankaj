{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testimonials | Anjali Bansal & Associates | Company Secretaries</title>
    <link rel="stylesheet" href="{% static 'css/testimonials.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css">

</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <h1>ANJALI BANSAL & ASSOCIATES</h1>
                <p>COMPANY SECRETARIES</p>
            </div>
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
            <nav class="nav-menu" id="navMenu">
                <ul>
                    <li><a href="{% url 'index' %}">Home</a></li>
                    <li><a href="{% url 'about' %}">About</a></li>
                    <li><a href="{% url 'our_expertise' %}">Expertise</a></li>
                    <li><a href="{% url 'blogs' %}">Articles</a></li>
                    <li><a href="{% url 'testimonials' %}" class="active">Testimonials</a></li>
                    <li><a href="{% url 'contact' %}">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Hero Banner -->
    <section class="testimonials-hero">
        <div class="container">
            <div class="testimonials-hero-content">
                <h1 class="page-title">Client Testimonials</h1>
                <p class="page-subtitle">Trusted by businesses across industries. Read what our clients have to say about our corporate secretarial services and partnership.</p>
                <div class="breadcrumb">
                    <a href="{% url 'index' %}">Home</a> / <span>Testimonials</span>
                </div>
            </div>
        </div>
        <div class="hero-overlay"></div>
        <div class="hero-shape">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                <path fill="#ffffff" fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
        </div>
    </section>

    <!-- Debug Section (Keep this - you can remove later) -->
    <section class="debug-section">
        <div class="container">
            <h4><i class="fas fa-bug me-2"></i>Debug Info</h4>
            <p>Total Testimonials: <strong>{{ all_testimonials|length }}</strong></p>
            <p>Featured Testimonials: <strong>{{ featured_testimonials|length }}</strong> (Shows ALL featured, not limited to 4)</p>
            <p>Video Testimonials: <strong>{{ video_testimonials|length }}</strong></p>
            <p>Industries Served: <strong>{{ stats.industries_served }}</strong></p>
            
            {% if all_testimonials %}
            <h5 class="mt-4">All Testimonials in Database:</h5>
            <ul>
                {% for t in all_testimonials %}
                <li>
                    <strong>{{ t.client_name }}</strong> - {{ t.company }} 
                    <span class="badge bg-{% if t.is_featured %}success{% else %}secondary{% endif %} ms-2">
                        {% if t.is_featured %}Featured{% else %}Regular{% endif %}
                    </span>
                    <span class="badge bg-info ms-1">{{ t.industry }}</span>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p class="text-danger">No testimonials in queryset. Check database and filters.</p>
            {% endif %}
        </div>
    </section>

    <!-- Submit CTA Section -->
    <section class="submit-cta-section">
        <div class="container text-center">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-body py-5 px-4">
                            <h3 class="mb-3">
                                <i class="fas fa-microphone-alt me-2" style="color: var(--accent-color);"></i>
                                Share Your Experience
                            </h3>
                            <p class="lead mb-4">
                                Have you worked with Anjali Bansal & Associates? 
                                We'd love to hear about your experience!
                            </p>
                            <a href="{% url 'submit_testimonial' %}" class="btn-primary">
                                <i class="fas fa-plus-circle me-2"></i>Submit Your Testimonial
                            </a>
                            <p class="small mt-4 mb-0">
                                <i class="fas fa-shield-alt me-1"></i>
                                All submissions are reviewed before publishing
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Stats -->
    <section class="testimonials-stats">
        <div class="container">
            <div class="stats-intro text-center mb-5">
                <h2 class="mb-3">Trusted By Industry Leaders</h2>
                <p class="intro-text">
                    Our commitment to excellence has earned us the trust of businesses across sectors. Here's what our clients appreciate about our partnership.
                </p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-item text-center">
                    <div class="stat-number" data-count="{{ stats.total_clients }}">0</div>
                    <div class="stat-label">Happy Clients</div>
                </div>
                <div class="stat-item text-center">
                    <div class="stat-number" data-count="{{ stats.avg_rating }}">0</div>
                    <div class="stat-label">Average Rating</div>
                </div>
                <div class="stat-item text-center">
                    <div class="stat-number" data-count="{{ stats.industries_served }}">0</div>
                    <div class="stat-label">Industries Served</div>
                </div>
                <div class="stat-item text-center">
                    <div class="stat-number" data-count="98">0</div>
                    <div class="stat-label">Client Satisfaction %</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Testimonials Slider -->
    <section class="featured-testimonials py-5">
        <div class="container">
            <div class="section-title">
                <h2>Featured Testimonials</h2>
                <p class="section-subtitle">
                    Hear directly from our valued clients about their experience working with us.
                    <span class="d-block mt-2 text-accent" style="color: var(--accent-color); font-weight: 600;">
                        Showing {{ featured_testimonials|length }} featured testimonials
                    </span>
                </p>
            </div>
            
            <div class="testimonials-slider swiper">
                <div class="swiper-wrapper">
                    {% for testimonial in featured_testimonials %}
                    <div class="swiper-slide">
                        <div class="featured-testimonial">
                            <div class="testimonial-header">
                                {% if testimonial.client_image or testimonial.image_url %}
                                <div class="client-image">
                                    <img src="{% if testimonial.client_image %}{{ testimonial.client_image.url }}{% else %}{{ testimonial.image_url }}{% endif %}" alt="{{ testimonial.client_name }}">
                                </div>
                                {% else %}
                                <div class="client-image">
                                    <i class="fas fa-user"></i>
                                </div>
                                {% endif %}
                                <div class="client-info">
                                    <h4>{{ testimonial.client_name }}</h4>
                                    <p class="client-position">{{ testimonial.position }}{% if testimonial.company %}, {{ testimonial.company }}{% endif %}</p>
                                    <p class="client-industry">{{ testimonial.industry }}</p>
                                </div>
                                <div class="testimonial-rating">
                                    <div class="stars">
                                        {% with ''|center:testimonial.rating as range %}
                                        {% for _ in range %}
                                            <i class="fas fa-star"></i>
                                        {% endfor %}
                                        {% endwith %}
                                    </div>
                                    <span>{{ testimonial.rating }}.0</span>
                                </div>
                            </div>
                            <div class="testimonial-content">
                                <i class="fas fa-quote-left"></i>
                                <p>"{{ testimonial.content|truncatewords:60 }}"</p>
                            </div>
                            <div class="testimonial-footer">
                                {% if testimonial.services %}
                                <div class="service-tags">
                                    {% if testimonial.services %}
                                        {% for service in testimonial.services.split|slice:":3" %}
                                        <span>{{ service }}</span>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                                {% endif %}
                                <div class="testimonial-date">{{ testimonial.date_added|date:"F Y" }}</div>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="swiper-slide">
                        <div class="featured-testimonial text-center py-5" style="background: var(--light-bg);">
                            <i class="fas fa-comments fa-3x mb-3" style="color: var(--light-text); opacity: 0.5;"></i>
                            <h4 style="color: var(--primary-color);">No Featured Testimonials Yet</h4>
                            <p style="color: var(--light-text);">Be the first to share your experience!</p>
                            <a href="{% url 'submit_testimonial' %}" class="btn-primary mt-3">
                                <i class="fas fa-plus-circle me-2"></i>Submit Your Testimonial
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Navigation buttons -->
                <div class="swiper-button-next" style="color: var(--primary-color);"></div>
                <div class="swiper-button-prev" style="color: var(--primary-color);"></div>
                <div class="swiper-pagination"></div>
            </div>
        </div>
    </section>

    <!-- Industry Testimonials Section -->
    <section class="industry-testimonials py-5" style="background: var(--light-bg);">
        <div class="container">
            <div class="section-title">
                <h2>Testimonials by Industry</h2>
                <p class="section-subtitle">See how we've helped businesses across different sectors achieve compliance excellence</p>
            </div>
            
            <div class="industry-tabs">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="all">All Industries</button>
                    {% for industry_item in industry_data %}
                    <button class="tab-button" data-tab="{{ industry_item.slug }}">{{ industry_item.name }}</button>
                    {% endfor %}
                </div>
                
                <!-- All Testimonials Tab -->
                <div class="tab-content active" id="tab-all">
                    <div class="testimonials-grid">
                        {% for testimonial in all_testimonials %}
                        <div class="testimonial-card {% if testimonial.is_featured %}featured-border{% endif %}">
                            {% if testimonial.is_featured %}
                            <div class="featured-badge" style="position: absolute; top: 15px; right: 15px; background: var(--accent-color); color: white; padding: 3px 10px; border-radius: 12px; font-size: 0.7rem; font-weight: 700;">
                                <i class="fas fa-star me-1"></i>FEATURED
                            </div>
                            {% endif %}
                            <div class="testimonial-header">
                                {% if testimonial.client_image or testimonial.image_url %}
                                <div class="client-image">
                                    <img src="{% if testimonial.client_image %}{{ testimonial.client_image.url }}{% else %}{{ testimonial.image_url }}{% endif %}" alt="{{ testimonial.client_name }}">
                                </div>
                                {% else %}
                                <div class="client-image">
                                    <i class="fas fa-user"></i>
                                </div>
                                {% endif %}
                                <div class="client-info">
                                    <h4>{{ testimonial.client_name }}</h4>
                                    <p class="client-position">{{ testimonial.position }}{% if testimonial.company %}, {{ testimonial.company }}{% endif %}</p>
                                    <span class="client-industry">{{ testimonial.industry }}</span>
                                </div>
                                <div class="testimonial-rating">
                                    <div class="stars">
                                        {% with ''|center:testimonial.rating as range %}
                                        {% for _ in range %}
                                            <i class="fas fa-star"></i>
                                        {% endfor %}
                                        {% endwith %}
                                    </div>
                                </div>
                            </div>
                            <div class="testimonial-content">
                                <i class="fas fa-quote-left"></i>
                                <p>"{{ testimonial.content|truncatewords:45 }}"</p>
                            </div>
                            <div class="testimonial-footer">
                                {% if testimonial.services %}
                                <div class="service-tags">
                                    {% if testimonial.services %}
                                        {% for service in testimonial.services.split|slice:":2" %}
                                        <span>{{ service }}</span>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                                {% endif %}
                                <div class="testimonial-date">{{ testimonial.date_added|date:"M Y" }}</div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="empty-testimonial">
                            <i class="fas fa-comments"></i>
                            <h4>No Testimonials Yet</h4>
                            <p>Be the first to share your experience with Anjali Bansal & Associates!</p>
                            <a href="{% url 'submit_testimonial' %}" class="btn-primary mt-3">
                                <i class="fas fa-plus-circle me-2"></i>Submit Your Testimonial
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Industry-specific Tabs -->
                {% for industry_item in industry_data %}
                <div class="tab-content" id="tab-{{ industry_item.slug }}">
                    <div class="testimonials-grid">
                        {% for testimonial in industry_item.testimonials %}
                        <div class="testimonial-card">
                            <div class="testimonial-header">
                                {% if testimonial.client_image or testimonial.image_url %}
                                <div class="client-image">
                                    <img src="{% if testimonial.client_image %}{{ testimonial.client_image.url }}{% else %}{{ testimonial.image_url }}{% endif %}" alt="{{ testimonial.client_name }}">
                                </div>
                                {% else %}
                                <div class="client-image">
                                    <i class="fas fa-user"></i>
                                </div>
                                {% endif %}
                                <div class="client-info">
                                    <h4>{{ testimonial.client_name }}</h4>
                                    <p class="client-position">{{ testimonial.position }}, {{ testimonial.company }}</p>
                                    <span class="client-industry">{{ testimonial.industry }}</span>
                                </div>
                                <div class="testimonial-rating">
                                    <div class="stars">
                                        {% with ''|center:testimonial.rating as range %}
                                        {% for _ in range %}
                                            <i class="fas fa-star"></i>
                                        {% endfor %}
                                        {% endwith %}
                                    </div>
                                </div>
                            </div>
                            <div class="testimonial-content">
                                <i class="fas fa-quote-left"></i>
                                <p>"{{ testimonial.content|truncatewords:40 }}"</p>
                            </div>
                            <div class="testimonial-footer">
                                {% if testimonial.services %}
                                <div class="service-tags">
                                    {% for service in testimonial.services.split|slice:":2" %}
                                    <span>{{ service }}</span>
                                    {% endfor %}
                                </div>
                                {% endif %}
                                <div class="testimonial-date">{{ testimonial.date_added|date:"M Y" }}</div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="empty-testimonial">
                            <i class="fas fa-industry"></i>
                            <h4>No {{ industry_item.name }} Testimonials Yet</h4>
                            <p>Be the first from the {{ industry_item.name }} industry to share your experience!</p>
                            <a href="{% url 'submit_testimonial' %}" class="btn-primary mt-3">
                                <i class="fas fa-plus-circle me-2"></i>Submit Your Testimonial
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Video Testimonials -->
    <section class="video-testimonials py-5">
        <div class="container">
            <div class="section-title">
                <h2>Video Testimonials</h2>
                <p class="section-subtitle">Hear our clients share their experiences in their own words</p>
            </div>

            <div class="video-grid">
                {% for testimonial in video_testimonials %}
                <div class="video-item">
                    <div class="video-thumbnail" data-video="{{ testimonial.get_video_source }}" data-title="{{ testimonial.client_name }}, {{ testimonial.company }}">
                        {% if testimonial.video_thumbnail %}
                            <img src="{{ testimonial.video_thumbnail.url }}" alt="" style="width: 100%; height: 250px; object-fit: cover;">
                        {% else %}
                            <img src="{% static 'img/video-placeholder.jpg' %}" alt="" style="width: 100%; height: 250px; object-fit: cover;">
                        {% endif %}
                        <div class="play-button">
                            <i class="fas fa-play"></i>
                        </div>
                        <div class="video-overlay" style="position: absolute; bottom: 0; left: 0; right: 0; background: rgba(26, 58, 95, 0.8); color: white; padding: 15px;">
                            <p style="margin: 0; font-size: 0.9rem;">{{ testimonial.content|truncatewords:15 }}</p>
                        </div>
                    </div>
                    <div class="video-info">
                        <h4>{{ testimonial.client_name }}, {{ testimonial.company }}</h4>
                        <p>{{ testimonial.industry }}</p>
                    </div>
                </div>
                {% empty %}
                <div class="empty-testimonial" style="grid-column: 1 / -1;">
                    <i class="fas fa-video"></i>
                    <h4>No Video Testimonials Yet</h4>
                    <p>Check back soon for video testimonials from our clients!</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Client Logos -->
    <section class="client-logos">
        <div class="container">
            <div class="section-title">
                <h2>Our Esteemed Clients</h2>
                <p class="section-subtitle">Trusted by industry leaders across sectors</p>
            </div>
            
            <div class="logos-grid">
                <div class="logo-item text-center">
                    <div class="logo-img">
                        <i class="fas fa-building"></i>
                        <span>TechNova Solutions</span>
                    </div>
                </div>
                <div class="logo-item text-center">
                    <div class="logo-img">
                        <i class="fas fa-industry"></i>
                        <span>GreenEarth Organics</span>
                    </div>
                </div>
                <div class="logo-item text-center">
                    <div class="logo-img">
                        <i class="fas fa-chart-line"></i>
                        <span>FinTech Innovations</span>
                    </div>
                </div>
                <div class="logo-item text-center">
                    <div class="logo-img">
                        <i class="fas fa-pills"></i>
                        <span>Global Pharma Inc.</span>
                    </div>
                </div>
                <div class="logo-item text-center">
                    <div class="logo-img">
                        <i class="fas fa-shopping-cart"></i>
                        <span>RetailChain India</span>
                    </div>
                </div>
                <div class="logo-item text-center">
                    <div class="logo-img">
                        <i class="fas fa-university"></i>
                        <span>Capital Bank</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="testimonials-cta">
        <div class="container">
            <div class="cta-content text-center">
                <div class="cta-text mb-4">
                    <h3>Ready to Experience Excellence?</h3>
                    <p>
                        Join our satisfied clients who trust us with their compliance needs. Let's start a conversation about how we can support your business.
                    </p>
                </div>
                <div class="cta-buttons">
                    <a href="{% url 'contact' %}" class="btn-primary me-3">
                        <i class="fas fa-handshake me-2"></i>Schedule Consultation
                    </a>
                    <a href="{% url 'our_expertise' %}" class="btn-secondary">
                        <i class="fas fa-chart-line me-2"></i>View Our Services
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div style="max-width: 1200px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: space-between; gap: 40px;">
            
            <div style="flex: 1; min-width: 250px;">
                <h3>ANJALI BANSAL & ASSOCIATES</h3>
                <p>
                    Providing quality services with transparency and integrity. Follow us on our journey to excellence.
                </p>
            </div>

            <div style="flex: 1; min-width: 150px;">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="{% url 'index' %}">Home</a></li>
                    <li><a href="{% url 'about' %}">About Us</a></li>
                    <li><a href="{% url 'our_expertise' %}">Services</a></li>
                    <li><a href="{% url 'contact' %}">Contact</a></li>
                </ul>
            </div>

            <div style="flex: 1; min-width: 150px;">
                <h4>Legal Support</h4>
                <ul>
                    <li><a href="{% url 'privacy_policy' %}">Privacy Policy</a></li>
                    <li><a href="{% url 'terms_and_conditions' %}">Terms & Conditions</a></li>
                    <li><a href="{% url 'refund_policy' %}">Refund Policy</a></li>
                    <li><a href="{% url 'disclaimer' %}">Disclaimer</a></li>
                </ul>
            </div>
        </div>

        <hr>

        <div style="max-width: 1200px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; font-size: 14px; color: #8a94a6;">
            <p>&copy; 2025 Anjali Bansal & Associates. All Rights Reserved.</p>
            <div style="display: flex; gap: 20px;">
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-linkedin"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </footer>

    <!-- Video Modal -->
    <div class="video-modal" id="videoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Client Testimonial</h3>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <video id="videoPlayer" controls autoplay style="width:100%; border-radius:12px; display:none;"></video>
                <iframe id="videoIframe" allowfullscreen style="width:100%; height:400px; border:none; display:none;"></iframe>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="{% static 'js/testimonials.js' %}"></script>
    
    <script>
        // Tab switching functionality
        document.addEventListener('DOMContentLoaded', function() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Remove active class from all buttons and contents
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to current button and corresponding content
                    this.classList.add('active');
                    document.getElementById(`tab-${tabId}`).classList.add('active');
                });
            });
            
            // Initialize Swiper for featured testimonials
            const swiper = new Swiper('.testimonials-slider', {
                slidesPerView: 1,
                spaceBetween: 30,
                loop: true,
                autoplay: {
                    delay: 6000,
                    disableOnInteraction: false,
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                breakpoints: {
                    768: {
                        slidesPerView: 2,
                    },
                    1024: {
                        slidesPerView: 3,
                    }
                }
            });
            
            // Animate stats counter
            const statNumbers = document.querySelectorAll('.stat-number');
            statNumbers.forEach(stat => {
                const target = parseFloat(stat.getAttribute('data-count'));
                const increment = target / 100;
                let current = 0;
                
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        stat.textContent = target.toFixed(1);
                        clearInterval(timer);
                    } else {
                        stat.textContent = Math.floor(current);
                    }
                }, 20);
            });
        });
        
        function splitServices(servicesString) {
            if (!servicesString) return [];
            return servicesString.split(',').map(s => s.trim()).filter(s => s);
        }
    </script>
</body>
</html>